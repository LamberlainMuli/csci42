{% extends 'base.html' %}
{% load static %}
{% block content %}
<main class="container mt-4">
  <article class="product-details">
    <header>
      <h1 class="product-title">{{ product.title }}</h1>
    </header>
    <section class="mb-3">
      {% if primary_image %}
        <img src="{{ primary_image.image.url }}" alt="{{ product.title }}" class="img-fluid" style="max-width:300px;">
      {% else %}
        <p>No image available.</p>
      {% endif %}
    </section>
    <section>
      <p><strong>Seller:</strong> {{ product.seller.username }}</p>
      <p><strong>Description:</strong> {{ product.description }}</p>
      <p><strong>Price:</strong> {{ formatted_price|default:product.price }}</p>
      <p><strong>Available Quantity:</strong> {{ product.quantity }}</p>
      <p><strong>Size:</strong> {{ product.size }}</p>
      <p><strong>Color:</strong> {{ product.color }}</p>
      <p><strong>Material:</strong> {{ product.material }}</p>
      <p><strong>Category:</strong> {{ product.get_category_display }}</p>
      <p><strong>Condition:</strong> {{ product.get_condition_display }}</p>
      <p><strong>Created At:</strong> {{ product.created_at|date:"M d, Y" }}</p>
      <p><strong>Updated At:</strong> {{ product.updated_at|date:"M d, Y" }}</p>
      <p><strong>Status:</strong> {% if product.is_sold %} Sold {% else %} Available {% endif %}</p>
    </section>
  </article>

  <nav class="product-actions mt-4" aria-label="Product Actions">
    <a href="{% url 'marketplace:home' %}" class="btn btn-secondary" aria-label="Back to Home">
      <i class="fas fa-home" aria-hidden="true"></i> Back to Home
    </a>
    {% if product.is_public %}
      {% if not user.is_authenticated or product.seller.id != user.id %}
        <a href="{% url 'cart:add_to_saved' product.id %}" class="btn btn-outline-secondary" aria-label="Save for later">
          <i class="fas fa-heart" aria-hidden="true"></i> Save for later
        </a>
        <a href="{% url 'cart:add_to_cart' product.id %}" class="btn btn-outline-primary" aria-label="Add to cart">
          <i class="fas fa-shopping-cart" aria-hidden="true"></i> Add to cart
        </a>
      {% endif %}
    {% endif %}
    <a href="#" class="btn btn-outline-info" aria-label="Chat">
      <i class="fas fa-comments" aria-hidden="true"></i> Chat
    </a>
    {% if user.is_authenticated and product.seller.id == user.id %}
      <a href="{% url 'marketplace:product-update' product.pk %}" class="btn btn-warning" aria-label="Edit Product">
        <i class="fas fa-edit" aria-hidden="true"></i> Edit Product
      </a>
      <a href="{% url 'marketplace:replace_product_image' product.pk %}" class="btn btn-secondary" aria-label="Replace Image">
        <i class="fas fa-image" aria-hidden="true"></i> Replace Image
      </a>
    {% endif %}
  </nav>
</main>
{% endblock %}
